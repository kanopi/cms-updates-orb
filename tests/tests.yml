version: 2.1

orbs:
  # Todo: Figure out a way to make the tag dynamic in local build.
  cms-updates: kanopi/cms-updates@dev:alpha

workflows:
  test:
    jobs:
      - cms-updates/run-update:
          name: "coit-8"
          cms: "drupal"
          repo: "git@github.com:kanopi/coit-8"
          pr-branch: "master"
          docroot: "web"
          update-branch: "cms-updates/test"
          site-hosting: "pantheon"
          site-id: "coit-main"
          site-env: "live"
          update-method: "composer"
          run-local: true
      - cms-updates/run-update:
          name: "coit-spot-removal"
          cms: "drupal7"
          repo: "git@github.com:kanopi/coit-spot-removal"
          pr-branch: "master"
          update-branch: "cms-updates/test"
          site-hosting: "pantheon"
          site-id: "coit-spot-removal"
          site-env: "live"
          update-method: "drush"
          run-local: true
      - cms-updates/run-update:
          name: "mises"
          cms: "drupal7"
          repo: "git@github.com:kanopi/mises"
          pr-branch: "main"
          update-branch: "cms-updates/test"
          site-hosting: "pantheon"
          site-id: "mises"
          site-env: "live"
          update-method: "drush"
          run-local: true
      - cms-updates/run-update:
          name: "mises-api"
          cms: "drupal"
          repo: "git@github.com:kanopi/mises-api"
          pr-branch: "main"
          docroot: "web"
          update-branch: "cms-updates/test"
          site-hosting: "pantheon"
          site-id: "mises-api"
          site-env: "dev"
          update-method: "composer"
          run-local: true
      - cms-updates/run-update:
          name: "kanopi-2019"
          cms: "wordpress"
          repo: "git@github.com:kanopi/kanopi-2019"
          pr-branch: "master"
          docroot: "web"
          update-branch: "cms-updates/test"
          site-hosting: "pantheon"
          site-id: "kanopi-2019"
          site-env: "live"
          update-method: "composer"
          composer-version: '1'
          run-local: true
      - cms-updates/run-update:
          name: "diebenkorn"
          cms: "wordpress"
          repo: "git@github.com:kanopi/diebenkorn"
          pr-branch: "main"
          update-branch: "cms-updates/test"
          site-hosting: "pantheon"
          site-id: "diebenkorn"
          site-env: "live"
          update-method: "wpcli"
          run-local: true
      - cms-updates/run-update:
          name: "veritext"
          cms: "wordpress"
          repo: "git@github.com:kanopi/veritext"
          pr-branch: "main"
          update-branch: "cms-updates/test"
          site-hosting: "wpengine"
          site-id: "veritext"
          update-method: "wpcli"
          run-local: true
      - cms-updates/run-update:
          name: "iocdf"
          cms: "wordpress"
          repo: "git@github.com:kanopi/iocdf"
          pr-branch: "master"
          update-branch: "cms-updates/test"
          site-hosting: "wpengine"
          site-id: "interna2785"
          update-method: "wpcli"
          is-multisite: true
          multisite-subdomains: true
          run-local: true
